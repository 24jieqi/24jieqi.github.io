{"componentChunkName":"component---src-templates-blog-post-js","path":"/frontEnd/其他/cicd-cli/cli/","result":{"data":{"site":{"siteMetadata":{"title":"HJGP技术知识库"}},"markdownRemark":{"id":"1349b686-f399-5195-9500-4eb6f34a0898","excerpt":"自动部署 github actions 目录： 下所有 yml 文件 nginx 配置 测试 nginx 配置文件 编辑配置 :wq 保存并退出 重启 nginx","html":"<h1>自动部署</h1>\n<h2>github actions</h2>\n<p>目录：<code class=\"language-text\">.github/workflows</code> 下所有 yml 文件</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token comment\"># This is a basic workflow to help you get started with Actions</span>\n\n<span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> CI\n\n<span class=\"token comment\"># Controls when the workflow will run</span>\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Triggers the workflow on push or pull request events but only for the main branch</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>main<span class=\"token punctuation\">]</span>\n  <span class=\"token comment\">#   pull_request:</span>\n  <span class=\"token comment\">#     branches: [ main ]</span>\n\n  <span class=\"token comment\"># Allows you to run this workflow manually from the Actions tab</span>\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\n\n<span class=\"token comment\"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span>\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># This workflow contains a single job called \"build\"</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># The type of runner that the job will run on</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n\n    <span class=\"token comment\"># Steps represent a sequence of tasks that will be executed as part of the job</span>\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n\n      <span class=\"token comment\"># Runs a single command using the runners shell</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> 安装依赖\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm install <span class=\"token punctuation\">-</span>g cross<span class=\"token punctuation\">-</span>env\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install yarn\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm install <span class=\"token punctuation\">-</span>g yarn\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> test local\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> ls\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install project dependencies\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> yarn\n\n      <span class=\"token comment\"># Runs a set of commands using the runners shell</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> build\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run build\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SCP Files\n        <span class=\"token comment\"># You may pin to the exact commit or the version.</span>\n        <span class=\"token comment\"># uses: appleboy/scp-action@b476d5806f2a4c1ed5902a87fa91b0623cac7258</span>\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> appleboy/scp<span class=\"token punctuation\">-</span>action@master\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> 173.242.xx.xxx\n          <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> root\n          <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> xxxxxx\n          <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">123</span>\n          <span class=\"token key atrule\">source</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"dist/*\"</span>\n          <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/usr/share/nginx/xxxx/\"</span></code></pre></div>\n<h2>nginx 配置</h2>\n<ol>\n<li>测试 nginx 配置文件</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nginx -t</code></pre></div>\n<ol start=\"2\">\n<li>编辑配置 :wq 保存并退出</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vim nginx.conf</code></pre></div>\n<ol start=\"3\">\n<li>重启 nginx</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nginx -s reload</code></pre></div>","frontmatter":{"title":"github自动部署","date":"2021-11-02","description":null,"author":"ming"}},"previous":{"fields":{"slug":"/frontEnd/其他/baidu-map/map/"},"frontmatter":{"title":"百度地图 GIS 测试文章"}},"next":{"fields":{"slug":"/frontEnd/其他/commitlint/commitlint/"},"frontmatter":{"title":"commitlint提交规范"}}},"pageContext":{"id":"1349b686-f399-5195-9500-4eb6f34a0898","previousPostId":"76dfe404-f2f8-5abb-992c-c5bfe33b9a97","nextPostId":"5af984f2-2339-5ddd-8cf7-0a4ebfa045ab"}},"staticQueryHashes":["2841359383","3257411868"]}